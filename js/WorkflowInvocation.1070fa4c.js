(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["WorkflowInvocation","History","EditableLabel","FunctionIcon"],{"020e":function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-button-group",{staticClass:"galaxy-history-functions"},[t._t("default",null,{item:t.item})],2)},a=[],i=n("c9c5"),r={name:"HistoryFunctions",props:{item:{type:i["default"],required:!0}}},l=r,o=(n("0ab0"),n("2877")),u=Object(o["a"])(l,s,a,!1,null,"ef52dcde",null);e["default"]=u.exports},"02aa":function(t,e,n){"use strict";var s=n("bec7"),a=n.n(s);a.a},"07ac":function(t,e,n){var s=n("23e7"),a=n("6f53").values;s({target:"Object",stat:!0},{values:function(t){return a(t)}})},"0ab0":function(t,e,n){"use strict";var s=n("2fe1"),a=n.n(s);a.a},"257e2":function(t,e,n){"use strict";n.r(e);var s,a,i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"galaxy-workflow-invocation"},[t.model.history?n("History",{attrs:{model:t.model.history},on:{"galaxy-history-deleted":t.history_deleted},scopedSlots:t._u([{key:"default",fn:function(e){return[t._t("default",null,{history:e,invocation:this}),n("span",{staticClass:"galaxy-workflow-invocation-state",class:t.state},[t._v(t._s(t.state_label(t.state)))]),n("span",{staticClass:"galaxy-workflow-invocation-progress",class:t.state},[n("b-progress",{staticClass:"w-100",attrs:{max:t.step_count()}},[n("b-progress-bar",{attrs:{variant:"success",animated:!1,value:(t.states["scheduled"]||0)+(t.states["ok"]||0),title:t.progress_label("ok")}},[t._v(t._s(t.progress_label("ok")))]),n("b-progress-bar",{attrs:{variant:"success",animated:!0,value:t.states["running"],title:t.progress_label("running")}},[t._v(t._s(t.progress_label("running")))]),n("b-progress-bar",{attrs:{variant:"danger",animated:!0,value:t.states["error"],title:t.progress_label("error")}},[t._v(t._s(t.progress_label("error")))]),n("b-progress-bar",{attrs:{variant:"info",animated:!1,value:(t.states["new"]||0)+(t.states["queued"]||0),title:t.progress_label("new")}},[t._v(t._s(t.progress_label("new")))])],1)],1),t._t("end",null,{history:e,invocation:this})]}},{key:"functions",fn:function(){return[t._t("functions",null,null,t.self),"failed"===t.model.state||t.states.error?n("ErrorInfo",t._g({attrs:{item:t.self}},t.$listeners)):t._e()]},proxy:!0}],null,!0)}):t._e()],1)},r=[],l=(n("7db0"),n("4fad"),n("07ac"),n("3835")),o=n("c9c5"),u=n("6d1e"),c={extends:u["default"],name:"ErrorInfo",props:{icon:{type:String,default:"icon-errorinfo"},label:{type:String,default:"Error Info"},description:{type:String,default:"View error log"},item:{type:v,required:!0},action:{type:Function,required:!1,default:function(){var t=this;this.item.model.get_error_log().then((function(e){t.item.$bvModal.msgBoxOk(t.item.$createElement("pre",{class:"error-log"},[e]),{title:"Error",size:"xl",buttonSize:"sm",okVariant:"danger",headerClass:"p-2 border-bottom-0",footerClass:"p-2 border-top-0",centered:!0})}))}}}},d=c,f=n("2877"),p=Object(f["a"])(d,s,a,!1,null,"28e6959c",null),m=p.exports,h=n("9615"),b=n("d86b"),_={name:"WorkflowInvocation",components:{History:o["default"],ErrorInfo:m},props:{model:{type:h["WorkflowInvocation"],required:!0}},data:function(){return{self:this}},methods:{step_count:function(){return Object.values(this.states).reduce((function(t,e){return t+e}),0)},state_label:function(t){return"new"===t?"queued":t},progress_label:function(t){if(0===Object.values(this.states).length)return"";if("ok"===t){if(this.done)return"done";if(t in this.states)return this.states[t]+" done";if("scheduled"in this.states)return this.states["scheduled"]+" done"}return this.done?"":"running"===t?this.states[t]+" running":"new"===t&&t in this.states?this.states[t]+" pending":"new"===t&&"queued"in this.states?this.states["queued"]+" pending":"error"===t?this.states[t]+" failed":void 0},history_deleted:function(){this.model.delete()}},computed:{states:function(){return this.model.states()},state:function(){return this.model.aggregate_state()},done:function(){var t=Object.values(this.outputs);return t.length>0&&t.every((function(t){return"ok"===t.state||"ok"===t.populated_state}))},outputs:function(){return Object.entries(this.model.all_outputs()).reduce((function(t,e){var n=Object(l["a"])(e,2),s=n[0],a=n[1],i=b["srcMap"][a.src].find(a.id);return i&&(t[s]=i),t}),{})}},created:function(){var t=this;this.model.poll_state_callback((function(t){return t.aggregate_state()}),(function(){return t.$emit("workflow-completed",t),t.states.pending&&console.log(t.model),t.model.getOutputs(),!0}),{params:{view:"element",step_details:!0}})},beforeDestroy:function(){this.model&&this.model.stop_polling()}},y=_,g=(n("8492"),Object(f["a"])(y,i,r,!1,null,"166f4535",null)),v=e["default"]=g.exports},"2fe1":function(t,e,n){},"6d1e":function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-link",{staticClass:"galaxy-function",attrs:{title:t.description,href:""},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.do_action(e)}}},[n("i",{staticClass:"galaxy-function-icon",class:t.icon}),t._v(" "+t._s(t.label)+" ")])},a=[],i={name:"FunctionIcon",props:{icon:{type:String,default:""},label:{type:String,default:""},description:{type:String,default:""},action:{type:Function,required:!0}},methods:{do_action:function(){this.action.call(this)}}},r=i,l=n("2877"),o=Object(l["a"])(r,s,a,!1,null,"12118e96",null);e["default"]=o.exports},8492:function(t,e,n){"use strict";var s=n("eb25"),a=n.n(s);a.a},"8a70":function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"editable-label"},[null===t.edited_label?[t._v(t._s(t.value))]:n("b-input",{ref:"editbox",attrs:{pattern:t.pattern,formatter:function(t){return t.trim()},placeholder:t.placeholder,autofocus:""},on:{keypress:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.stop_edit(e)},blur:t.stop_edit,click:function(t){t.stopPropagation()}},model:{value:t.edited_label,callback:function(e){t.edited_label=e},expression:"edited_label"}})],2)},a=[],i={name:"EditableLabel",props:{value:{type:String,required:!0},placeholder:{type:String,default:""},pattern:{type:String,default:".+"}},data:function(){return{edited_label:null}},methods:{start_edit:function(){var t=this;this.edited_label=this.value,this.$nextTick((function(){t.$refs.editbox.focus(),t.$refs.editbox.select()}))},stop_edit:function(){null!==this.edited_label&&this.$emit("update",this.edited_label),this.edited_label=null},cancel_edit:function(){this.edited_label=null}}},r=i,l=(n("02aa"),n("2877")),o=Object(l["a"])(r,s,a,!1,null,"7f2facec",null);e["default"]=o.exports},bec7:function(t,e,n){},c9c5:function(t,e,n){"use strict";n.r(e);var s,a,i,r,l=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"galaxy-history"},[n("EditableLabel",{ref:"label",staticClass:"galaxy-history-label",attrs:{value:t.model.name,placeholder:"Enter a label"},on:{update:t.update_label}}),n("span",{staticClass:"galaxy-history-state"},[t._v(t._s(t.model.state))]),n("time",{staticClass:"galaxy-history-updated",attrs:{datetime:t.model.update_time}},[t._v(t._s(new Date(t.model.update_time).toLocaleDateString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"})))]),t._t("default",null,{model:t.model}),n("HistoryFunctions",{attrs:{item:t.self},scopedSlots:t._u([{key:"default",fn:function(e){return[t._t("functions",null,null,t.self),n("RenameHistory",{attrs:{item:e.item},on:{"galaxy-history-rename":function(e){return t.$refs.label.start_edit()}}}),n("RemoveHistory",t._g({attrs:{item:e.item}},t.$listeners))]}}],null,!0)}),t._t("contents",null,null,t.self)],2)},o=[],u=(n("b0c0"),n("1f26")),c=n("8a70"),d=n("020e"),f=n("6d1e"),p={extends:f["default"],name:"Remove",props:{icon:{type:String,default:"icon-trash"},label:{type:String,default:"Remove"},description:{type:String,default:"Remove this history"},item:{type:$,required:!0},action:{type:Function,default:function(){this.item.model.delete(),this.$emit("galaxy-history-deleted",this.item.model)}}}},m=p,h=n("2877"),b=Object(h["a"])(m,s,a,!1,null,"c6dfabfe",null),_=b.exports,y={extends:f["default"],name:"Rename",props:{icon:{type:String,default:"icon-rename"},label:{type:String,default:"Rename"},description:{type:String,default:"Rename this item"},item:{type:$,required:!0},action:{type:Function,default:function(){this.$emit("galaxy-history-rename",this.item.model)}}}},g=y,v=Object(h["a"])(g,i,r,!1,null,"404c3020",null),x=v.exports,k={name:"History",components:{HistoryFunctions:d["default"],RemoveHistory:_,RenameHistory:x,EditableLabel:c["default"]},props:{model:{type:u["History"],required:!0}},data:function(){return{self:this}},methods:{update_label:function(t){this.model.name=t,this.model.put(["name"])}},created:function(){var t=this;this.model.poll_state((function(){return t.$emit("history-completed",t),!0}))},beforeDestroy:function(){this.model&&this.model.stop_polling()}},w=k,S=Object(h["a"])(w,l,o,!1,null,"06e281fc",null),$=e["default"]=S.exports},eb25:function(t,e,n){}}]);
//# sourceMappingURL=WorkflowInvocation.1070fa4c.js.map